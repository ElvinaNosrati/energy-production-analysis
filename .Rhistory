knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
library(readr)
df <- read_csv("/mnt/data/Amberd.csv")
library(readxl)
Amberd <- read_excel("~/Desktop/Amberd.xlsx")
View(Amberd)
df <- read_csv("/mnt/data/Amberd.csv")
df <- read_csv("/mnt/Desktop/Amberd.csv")
getwd()
setwd("/Users/elvinanosrati/Desktop")
df <- read_csv("/mnt/Desktop/Amberd.csv")
df <- read_csv("Amberd.csv")
setwd("/Users/elvinanosrati/Capstone")
df <- read_csv("Amberd.csv")
library(readxl)
Amberd <- read_excel("Amberd.xlsx")
View(Amberd)
df <- read_csv("Amberd.csv")
df <- read_excel("Amberd.xlsx")
# Convert Date column to Date type
df$Date <- as.Date(df$Date)
# Remove NA values
df <- df %>% drop_na(`Energy Production (kWh)`)
library(ggplot2)
library(dplyr)
library(readr)
df <- read_excel("Amberd.xlsx")
# Convert Date column to Date type
df$Date <- as.Date(df$Date)
# Remove NA values
df <- df %>% drop_na(`Energy Production (kWh)`)
library(tidyr)
df <- read_excel("Amberd.xlsx")
# Convert Date column to Date type
df$Date <- as.Date(df$Date)
# Remove NA values
df <- df %>% drop_na(`Energy Production (kWh)`)
# Plot 1: Time Series of Energy Production
p1 <- ggplot(df, aes(x = Date, y = `Energy Production (kWh)`, color = Station)) +
geom_line(alpha = 0.5) +
labs(title = "Time Series of Energy Production",
x = "Date",
y = "Energy Production (kWh)") +
theme_minimal()
# Plot 1: Time Series of Energy Production
p1 <- ggplot(df, aes(x = Date, y = `Energy Production (kWh)`, color = Station)) +
geom_line(alpha = 0.5) +
labs(title = "Time Series of Energy Production",
x = "Date",
y = "Energy Production (kWh)") +
theme_minimal()
print(p1)
# Plot 1: Time Series of Energy Production
p1 <- ggplot(df, aes(x = Date, y = `Energy Production (kWh)`, color = Station)) +
geom_line(alpha = 0.5) +
labs(title = "Time Series of Energy Production",
x = "Date",
y = "Energy Production (kWh)") +
theme_minimal()
print(p1)
# Plot 1: Time Series of Energy Production
p1 <- ggplot(df, aes(x = Date, y = `Energy Production (kWh)`, color = Station)) +
geom_line(alpha = 0.5) +
labs(title = "Time Series of Energy Production",
x = "Date",
y = "Energy Production (kWh)") +
theme_minimal()
# Plot 2: Average Energy Production by Hour
df %>%
group_by(`Hour Index`) %>%
summarise(avg_production = mean(`Energy Production (kWh)`, na.rm = TRUE)) %>%
ggplot(aes(x = `Hour Index`, y = avg_production)) +
geom_line(color = "blue") +
geom_point(color = "red") +
labs(title = "Average Energy Production by Hour",
x = "Hour Index",
y = "Avg Energy Production (kWh)") +
theme_minimal()
# Plot 3: Distribution of Energy Production per Station
ggplot(df, aes(x = `Energy Production (kWh)`, fill = Station)) +
geom_histogram(bins = 50, alpha = 0.7, position = "identity") +
labs(title = "Distribution of Energy Production per Station",
x = "Energy Production (kWh)",
y = "Count") +
theme_minimal()
# Plot 1: Time Series of Energy Production
p1 <- ggplot(df, aes(x = Date, y = `Energy Production (kWh)`, color = Station)) +
geom_line(alpha = 0.5) +
labs(title = "Time Series of Energy Production",
x = "Date",
y = "Energy Production (kWh)") +
theme_minimal()
# Plot 1: Time Series of Energy Production
ggplot(df, aes(x = Date, y = `Energy Production (kWh)`, color = Station)) +
geom_line(alpha = 0.5) +
labs(title = "Time Series of Energy Production",
x = "Date",
y = "Energy Production (kWh)") +
theme_minimal()
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
library(readr)
library(tidyr)
df <- read_excel("Amberd.xlsx")
# Plot 1: Time Series of Energy Production
ggplot(df, aes(x = Date, y = `Energy Production (kWh)`, color = Station)) +
geom_line(alpha = 0.5) +
labs(title = "Time Series of Energy Production",
x = "Date",
y = "Energy Production (kWh)") +
theme_minimal()
# Plot 2: Average Energy Production by Hour
df %>%
group_by(`Hour Index`) %>%
summarise(avg_production = mean(`Energy Production (kWh)`, na.rm = TRUE)) %>%
ggplot(aes(x = `Hour Index`, y = avg_production)) +
geom_line(color = "blue") +
geom_point(color = "red") +
labs(title = "Average Energy Production by Hour",
x = "Hour Index",
y = "Avg Energy Production (kWh)") +
theme_minimal()
# Plot 3: Distribution of Energy Production per Station
ggplot(df, aes(x = `Energy Production (kWh)`, fill = Station)) +
geom_histogram(bins = 50, alpha = 0.7, position = "identity") +
labs(title = "Distribution of Energy Production per Station",
x = "Energy Production (kWh)",
y = "Count") +
theme_minimal()
library(lubridate)
# Extract Month
df$Month <- month(df$Date, label = TRUE)
# Plot 3: Average Energy Production by Month
df %>%
group_by(Month) %>%
summarise(avg_production = mean(`Energy Production (kWh)`, na.rm = TRUE)) %>%
ggplot(aes(x = Month, y = avg_production, fill = Month)) +
geom_bar(stat = "identity", color = "black") +
labs(title = "Average Energy Production by Month",
x = "Month",
y = "Avg Energy Production (kWh)") +
theme_minimal()
# Extract Month
df$Month <- month(df$Date, label = TRUE)
# Plot 3: Average Energy Production by Month
df %>%
group_by(Month) %>%
summarise(avg_production = mean(`Energy Production (kWh)`, na.rm = TRUE)) %>%
ggplot(aes(x = Month, y = avg_production, fill = Month)) +
geom_bar(stat = "identity", color = "white") +
labs(title = "Average Energy Production by Month",
x = "Month",
y = "Avg Energy Production (kWh)") +
theme_minimal()
# Extract Month
df$Month <- month(df$Date, label = TRUE)
# Plot 3: Average Energy Production by Month
df %>%
group_by(Month) %>%
summarise(avg_production = mean(`Energy Production (kWh)`, na.rm = TRUE)) %>%
ggplot(aes(x = Month, y = avg_production, fill = Month)) +
geom_bar(stat = "identity", color = "white") +
labs(title = "Average Energy Production by Month",
x = "Month",
y = "Avg Energy Production (kWh)") +
theme_minimal()
# Plot 4: Energy Production by Station Over Time
ggplot(df, aes(x = Date, y = `Energy Production (kWh)`)) +
geom_line(color = "blue", alpha = 0.6) +
facet_wrap(~ Station, scales = "free_y") +  # Separate plots per station
labs(title = "Energy Production by Station Over Time",
x = "Date",
y = "Energy Production (kWh)") +
theme_minimal()
df$Month <- month(df$Date, label = TRUE)
df %>%
group_by(Month, `Hour Index`) %>%
summarise(avg_production = mean(`Energy Production (kWh)`, na.rm = TRUE)) %>%
ggplot(aes(x = `Hour Index`, y = Month, fill = avg_production)) +
geom_tile() +
labs(title = "Energy Production Heatmap (Hour vs. Month)",
x = "Hour of the Day",
y = "Month",
fill = "Avg Production (kWh)") +
theme_minimal()
ggplot(df, aes(x = Station, y = `Energy Production (kWh)`, fill = Station)) +
geom_boxplot() +
labs(title = "Energy Production Distribution by Station",
x = "Station",
y = "Energy Production (kWh)") +
theme_minimal()
library(zoo)
df <- df %>%
arrange(Date) %>%
group_by(Station) %>%
mutate(Rolling_Avg = rollmean(`Energy Production (kWh)`, k = 7, fill = NA))
ggplot(df, aes(x = Date, y = Rolling_Avg, color = Station)) +
geom_line() +
labs(title = "7-Day Rolling Average of Energy Production",
x = "Date",
y = "Rolling Avg Energy Production (kWh)") +
theme_minimal()
library(GGally)
df_numeric <- df %>% select(`Energy Production (kWh)`, `Hour Index`)
ggpairs(df_numeric, title = "Correlation Matrix of Energy Production Factors")
df$Year <- year(df$Date)  # Extracts the year
df$Month <- month(df$Date, label = TRUE)  # Extracts the month
df %>%
group_by(Year, Month) %>%  # Groups by both Year and Month
summarise(avg_production = mean(`Energy Production (kWh)`, na.rm = TRUE)) %>%
ggplot(aes(x = Month, y = avg_production, group = Year, color = as.factor(Year))) +
geom_line(size = 1) +
geom_point() +
labs(title = "Average Energy Production by Month (Each Year Separately)",
x = "Month",
y = "Avg Energy Production (kWh)",
color = "Year") +
theme_minimal()
df$Year <- year(df$Date)
df$Month <- month(df$Date, label = TRUE)
df %>%
group_by(Year, Month) %>%
summarise(avg_production = mean(`Energy Production (kWh)`, na.rm = TRUE)) %>%
ggplot(aes(x = Month, y = avg_production, fill = as.factor(Year))) +
geom_bar(stat = "identity", position = "dodge") +  # Bars side by side
labs(title = "Average Energy Production by Month (Grouped by Year)",
x = "Month",
y = "Avg Energy Production (kWh)",
fill = "Year") +
theme_minimal()
df$Year <- year(df$Date)  # Extracts the year
df$Month <- month(df$Date, label = TRUE)  # Extracts the month
df %>%
group_by(Year, Month) %>%  # Groups by both Year and Month
summarise(avg_production = mean(`Energy Production (kWh)`, na.rm = TRUE)) %>%
ggplot(aes(x = Month, y = avg_production, group = Year, color = as.factor(Year))) +
geom_line(size = 1) +
geom_point() +
labs(title = "Average Energy Production by Month (Each Year Separately)",
x = "Month",
y = "Avg Energy Production (kWh)",
color = "Year") +
theme_minimal()
library(ggplot2)
library(dplyr)
library(readxl)
library(lubridate)
library(tidyr)
df <- read_excel("Amberd.xlsx")
# Convert Date column to Date type
df$Date <- as.Date(df$Date)
# Remove NA values
df <- df %>% drop_na(`Energy Production (kWh)`)
